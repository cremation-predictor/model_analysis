# 1. 프로젝트 개요 (Project Overview)

대구·경북 지역의 월별 화장 수요를 예측하기 위한 모델을 개발하고자 함.  
핵심 포인트: 고령화, 사망원인, 계절성을 반영해 예측 정확도를 높일 수 있도록 한다.

---

# 2. 데이터셋 구조 (Dataset)

출처: 대구·경북 화장 관련 통계 (KOSIS, e하늘포털시스템)  
기간: 1998년 ~ 2023년  

기본 통계 정보 (사망자수, 날짜, 지역, 사망원인별 사망자수, 연령별 사망자수)를 활용해 데이터 분석을 진행,  
모델 학습 시에 활용할 수 있는 다양한 파생 변수를 생성하여 적용하였다.

## 📂 데이터셋 변수 설명

### 🔹 기본 정보
- `date`: 관측 연월 (YYYY-MM-DD)  
- `year`: 연도  
- `month`: 월 (1~12)  
- `region`: 지역 (대구 / 경북)  

---

### 🔹 타깃 변수
- `deaths_total`: 전체 사망자 수  
- `natl_total`: 전국 사망자 수  
- `natl_ratio`: 해당 지역 사망자수 / 전국 사망자수 비율  

---

### 🔹 시계열 파생 변수
- `deaths_total_lag1`: 1개월 전 사망자 수  
- `deaths_total_lag12`: 12개월 전 사망자 수  
- `deaths_rolling3`: 3개월 이동평균  
- `deaths_diff1`: 전월 대비 차분값 (1차 차분)  
- `diff2`: 2차 차분 (전월 대비 증감 추세 강화)  
- `rolling_std_3`: 최근 3개월 표준편차 (변동성 지표)  
- `rolling_std_6`: 최근 6개월 표준편차  

---

### 🔹 계절성 변수
- `month_sin`, `month_cos`: 월(month)의 주기적 특성 반영 (Fourier 변환)  
- `is_winter`: 겨울 여부 (12~2월 = 1)  
- `is_summer`: 여름 여부 (6~8월 = 1)  
- `season_spring`, `season_summer`, `season_winter`: 계절 더미 변수  

---

### 🔹 인구구조 변수
- `ratio_25_49`: 25~49세 인구 비율  
- `ratio_50_64`: 50~64세 인구 비율  
- `ratio_65_69`: 65~69세 인구 비율  
- `ratio_65_plus`: 65세 이상 인구 비율  
- `ratio_70_plus`: 70세 이상 인구 비율  
- `ratio_75_plus`: 75세 이상 인구 비율  
- `ratio_80_plus`: 80세 이상 인구 비율  
- `ratio_85_plus`: 85세 이상 인구 비율  

---

### 🔹 사망 원인별 변수
- `cause_cerebro`: 뇌혈관 질환 사망 비율  
- `cause_cancer`: 암 사망 비율  
- `cause_pneumonia`: 폐렴 사망 비율  
- `cause_cardio`: 심혈관 질환 사망 비율  

---

### 🔹 이벤트 관련 변수
- `event_dummy`: 특정 사건(예: 감염병 유행) 반영 더미  
- `winter_event`: 겨울철 이벤트(독감, 한파 등)  
- `summer_event`: 여름철 이벤트(폭염 등)  

---

### 🔹 복합 변수 (연령 × 계절 교차 효과)
- `elderly65_winter`: 겨울철 65세 이상 인구 효과  
- `elderly75_winter`: 겨울철 75세 이상 인구 효과  
- `elderly85_winter`: 겨울철 85세 이상 인구 효과  

---

### 🔹 추세 변수
- `expected_deaths`: 기대 사망자 수 (추세 기반)  
- `excess_mortality`: 초과 사망자 수 (실제 – 기대)  
- `year_sq`: 연도의 제곱 (비선형 추세 반영)  
- `era_2000s`, `era_2010s`, `era_2020s`: 시대 구분 더미 변수  

---

# 3. 전처리 (Preprocessing)

![전처리 과정](images/preprocessing.png)

- **결측치 처리**: 결측치가 포함된 행은 삭제(dropna) 처리하여 모델 학습 시 안정성을 확보  
  (초기 기획은 중앙값 대체였으나, 실험 결과 삭제 처리하는 것이 모델 성능이 더 높음을 확인)  
- **이상치 처리**: 신종플루·코로나 등 질병 관련 이벤트로 발생한 이상치는 의미 있는 정보로 간주 → 별도 제거하지 않고 모델 학습에 반영  
- **스케일링 여부**: Ridge, XGBoost 특성 상 별도 스케일링 불필요  

---

# 4. 모델링 (Modeling)

- **Baseline**: Linear Regression  
- **최종 모델**: Ridge Regression (규제 선형모델)  

## 📊 모델 성능 비교 (v6 데이터 기준)

### 🔹 Holdout 검증 (Train 64% / Valid 16% / Test 20%)
| Model         | MAE   | RMSE  | sMAPE | R²    | 분석 |
|---------------|-------|-------|-------|-------|------|
| Linear        | 25.7  | 32.9  | 1.33  | 0.983 | 선형 추세를 안정적으로 설명. 준수한 결과 |
| Ridge         | 24.8  | 32.4  | 1.27  | 0.984 | 가장 낮은 오차와 높은 설명력 → **최종 선택 모델** |
| Random Forest | 90.4  | 162.1 | 4.47  | 0.594 | 과적합 + 데이터 부족 → 성능 급격히 저하 |
| XGBoost       | 66.3  | 138.0 | 3.18  | 0.706 | 데이터 규모가 작아 비선형 모델은 불리 |

---

### 🔹 Cross-Validation (CV, 5-Fold, Purged)
| Model         | MAE   | RMSE  | sMAPE | R²    | 분석 |
|---------------|-------|-------|-------|-------|------|
| Linear        | 32.7  | 41.8  | 2.24  | 0.890 | Holdout 대비 성능 하락. CV에서는 변동성↑ |
| Ridge         | 23.5  | 30.3  | 1.42  | 0.938 | CV에서도 안정적. Holdout보다 더 낮은 오차 기록 |
| Random Forest | 202.2 | 238.0 | 14.36 | -2.799 | 극심한 과적합, 일반화 실패 |
| XGBoost       | 175.3 | 209.0 | 12.10 | -1.822 | 마찬가지로 일반화 실패 |

---

### 📌 검증 전략 설명
- **Holdout 검증**  
  - 데이터를 시간 순서대로 학습/검증/테스트로 분할 (64% / 16% / 20%)  
  - 직관적이고 간단하지만 특정 기간 데이터에 의존할 수 있음  

- **Cross-Validation (CV, 5-Fold, Purged)**  
  - 데이터를 5개 구간으로 나누어 반복 학습·검증  
  - **Purged 방식**: 시계열 데이터에서 훈련/검증 기간이 겹치지 않도록 설계  
  - 더 엄격하게 일반화 성능을 평가할 수 있음  
  - 결과적으로 Ridge만이 두 검증 모두에서 안정적인 성능을 보였음  

---

📌 결론:  
- **Ridge Regression**이 Holdout / CV 모두에서 가장 안정적이고 일반화 가능한 성능을 보임  
- 데이터가 적고 선형적 추세가 강해, 비선형 모델(Random Forest, XGBoost)은 일반화 실패  

![Ridge Regression 예측 결과](images/ridge_plot.png)

---

# 5. 결론 및 향후 확장 가능성 (Conclusion & Future Work)

### 결론
- 본 프로젝트는 대구·경북 지역의 인구 구조, 사망원인, 계절성 변수를 종합적으로 활용하여 **월별 화장 수요를 안정적으로 예측**하였다.  
- 특히 Ridge Regression은 선형 추세와 인구 고령화 효과를 잘 설명하며, Holdout과 CV 모두에서 안정적인 성능을 보였다.  

### 향후 확장 가능성
- **적용 범위 확대**: 화장 수요 예측뿐 아니라 장례 인프라 수요, 공공 보건 자원 배치, 고령화 정책 평가 등 다양한 분야에 활용 가능  
- **데이터 확장**: 기상 정보, 질병 발생 통계, 사회적 이벤트 데이터를 추가하여 단기 변동성을 더욱 정밀하게 반영 가능  
- **정책 시뮬레이션**: 인구 구조 변화 시나리오(예: 초고령사회 가속화)에 따른 장기 화장 수요 예측에도 활용 가능  